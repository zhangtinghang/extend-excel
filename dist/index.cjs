"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("xlsx"),t=require("file-saver"),r=require("lodash");function o(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var n=o(e);const s=(e,o,s)=>{const{fileName:a="export",sheetName:c="sheet1",XLSXOption:i={}}=s||{};if(!o||!Array.isArray(o))throw new Error("The sourceData needs to be in array format!");const l=r.chain(o).map((t=>{const o=r.cloneDeep(t);return Object.keys(o).reduce(((t,r)=>{if(e[r])if(e[r]&&"object"==typeof e[r]){const n=e[r].key,s=e[r].filter(o[r]);t[n]=s}else t[e[r]]=o[r];return t}),{})})).value(),p=n.utils.book_new(),u=n.utils.json_to_sheet(l);n.utils.book_append_sheet(p,u,c);const y={bookType:"xlsx",bookSST:!1,type:"array",...i},f=n.write(p,y);t.saveAs(new Blob([f],{type:"application/octet-stream"}),`${a}.xlsx`)},a=(e,t)=>{const{onlyFirst:r=!1,XLSXReadOptions:o={},keyMapping:s={}}=t||{},a=e.name,i=new FileReader;return i.readAsBinaryString(e),new Promise(((e,t)=>{i.onload=i=>{try{const t=i.target?.result,p=n.read(t,{type:"binary",...o});let u=[];for(var l in p.Sheets)if(p.Sheets.hasOwnProperty(l)&&(u=u.concat(n.utils.sheet_to_json(p.Sheets[l])),r))break;s&&Reflect.ownKeys(s).length>0&&(u=c(u,s)),e({name:a,data:u})}catch(e){t(e)}}}))},c=(e,t)=>{const r=[];for(let o=0;o<e.length;o++){const n=e[o],s={};for(const e in t)Object.prototype.hasOwnProperty.call(n,e)&&(s[t[e]]=n[e]);Reflect.ownKeys(s).length>0&&r.push(s)}return r},i={importExcel:a,exportExcel:s,keysMapping:c};exports.default=i,exports.exportExcel=s,exports.importExcel=a,exports.keysMapping=c;
